<?xml version="1.0" encoding="UTF-8"?>
<process xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:noNamespaceSchemaLocation="../../main/resources/petriNets/petriflow_schema.xsd">
    <id>request</id>
    <version>1.0.0</version>
    <title>New request</title>
    <icon>fact_check</icon>
    <defaultRole>true</defaultRole>
    <anonymousRole>true</anonymousRole>
    <role>
        <id>first</id>
        <title>First</title>
    </role>
    <role>
        <id>registration</id>
        <title>Registration</title>
    </role>
    <role>
        <id>second</id>
        <title>Second</title>
    </role>
    <role>
        <id>system</id>
        <title>System</title>
    </role>
    <role>
        <id>user</id>
        <title>User</title>
    </role>
    <data type="enumeration_map">
        <id>request_origin</id>
        <title>Origin of the request</title>
        <options>
            <option key="online">Online</option>
            <option key="call">Call</option>
        </options>
    </data>
    <data type="number">
        <id>customer_id</id>
        <title>Customer ID</title>
        <validations>
            <validation>
                <name>inrange</name>
                <serverArguments>
                    <argument>1000</argument>
                    <argument>2999</argument>
                </serverArguments>
            </validation>
        </validations>
    </data>
    <data type="taskRef">
        <id>form_ref</id>
        <title/>
        <init>t9</init>
    </data>
    <data type="text">
        <id>name</id>
        <title>Name</title>
    </data>
    <data type="text">
        <id>surname</id>
        <title>Surname</title>
        <placeholder>`</placeholder>
    </data>
    <data type="text">
        <id>email</id>
        <title>Email</title>
    </data>
    <data type="text">
        <id>request_text</id>
        <title>Request</title>
    </data>
    <data type="text">
        <id>answer_department</id>
        <title>Answer of the department</title>
    </data>
    <data type="text">
        <id>answer_registration</id>
        <title>Answer of the registration</title>
    </data>
    <data type="text">
        <id>status</id>
        <title>Status</title>
    </data>
    <transition>
        <id>t1</id>
        <x>496</x>
        <y>208</y>
        <title>Submit request</title>
        <roleRef>
            <id>user</id>
            <permission>
                <perform>true</perform>
            </permission>
        </roleRef>
        <flex>
            <id>t1_0</id>
            <item>
                <dataRef>
                    <id>form_ref</id>
                    <logic>
                        <behavior>editable</behavior>
                    </logic>
                </dataRef>
            </item>
        </flex>
        <event type="finish">
            <id>t1_finish</id>
            <actions phase="pre">
                <action id="1">
					<![CDATA[
                    change status value { "Request submitted." }
                    ]]>
				</action>
            </actions>
        </event>
    </transition>
    <transition>
        <id>t2</id>
        <x>752</x>
        <y>208</y>
        <title>Registration</title>
        <roleRef>
            <id>registration</id>
            <permission>
                <perform>true</perform>
            </permission>
        </roleRef>
        <flex>
            <id>t2_0</id>
            <item>
                <dataRef>
                    <id>request_origin</id>
                    <logic>
                        <behavior>editable</behavior>
                    </logic>
                    <component>
                        <id>list</id>
                    </component>
                </dataRef>
            </item>
            <item>
                <dataRef>
                    <id>form_ref</id>
                    <logic>
                        <behavior>visible</behavior>
                    </logic>
                </dataRef>
            </item>
        </flex>
        <event type="finish">
            <id>t2_finish</id>
            <actions phase="pre">
                <action id="2">
					<![CDATA[
                    change status value { "Request registered." }
                    ]]>
				</action>
            </actions>
            <actions phase="post">
                <action id="4">
					<![CDATA[
                    if (customer_id.rawValue < 2000) {
                        assignTask("t3")
                        finishTask("t3")
                    } else {
                        assignTask("t6")
                        finishTask("t6")
                    }
                    ]]>
				</action>
            </actions>
        </event>
    </transition>
    <transition>
        <id>t3</id>
        <x>976</x>
        <y>176</y>
        <title>To first</title>
        <roleRef>
            <id>system</id>
            <permission>
                <perform>true</perform>
            </permission>
        </roleRef>
    </transition>
    <transition>
        <id>t4</id>
        <x>1232</x>
        <y>176</y>
        <title>First department</title>
        <roleRef>
            <id>first</id>
            <permission>
                <perform>true</perform>
            </permission>
        </roleRef>
        <flex>
            <id>t4_0</id>
            <item>
                <dataRef>
                    <id>answer_department</id>
                    <logic>
                        <behavior>editable</behavior>
                        <required>true</required>
                    </logic>
                    <component>
                        <id>textarea</id>
                    </component>
                </dataRef>
            </item>
            <item>
                <dataRef>
                    <id>form_ref</id>
                    <logic>
                        <behavior>visible</behavior>
                    </logic>
                </dataRef>
            </item>
        </flex>
    </transition>
    <transition>
        <id>t5</id>
        <x>1456</x>
        <y>208</y>
        <title>Answer of the registration</title>
        <roleRef>
            <id>registration</id>
            <permission>
                <perform>true</perform>
            </permission>
        </roleRef>
        <flex>
            <id>t5_0</id>
            <item>
                <dataRef>
                    <id>answer_registration</id>
                    <logic>
                        <behavior>editable</behavior>
                        <required>true</required>
                    </logic>
                    <component>
                        <id>textarea</id>
                    </component>
                </dataRef>
            </item>
            <item>
                <dataRef>
                    <id>answer_department</id>
                    <logic>
                        <behavior>visible</behavior>
                    </logic>
                </dataRef>
            </item>
            <item>
                <dataRef>
                    <id>form_ref</id>
                    <logic>
                        <behavior>visible</behavior>
                    </logic>
                </dataRef>
            </item>
        </flex>
        <event type="finish">
            <id>t5_finish</id>
            <actions phase="pre">
                <action id="3">
					<![CDATA[
                    change status value { "Request finished." }
                    make answer_registration, visible on t8 when { true }
                    ]]>
				</action>
            </actions>
        </event>
    </transition>
    <transition>
        <id>t6</id>
        <x>976</x>
        <y>272</y>
        <title>To second</title>
        <roleRef>
            <id>system</id>
            <permission>
                <perform>true</perform>
            </permission>
        </roleRef>
    </transition>
    <transition>
        <id>t7</id>
        <x>1232</x>
        <y>272</y>
        <title>Second department</title>
        <roleRef>
            <id>second</id>
            <permission>
                <perform>true</perform>
            </permission>
        </roleRef>
        <flex>
            <id>t7_0</id>
            <item>
                <dataRef>
                    <id>answer_department</id>
                    <logic>
                        <behavior>editable</behavior>
                        <required>true</required>
                    </logic>
                </dataRef>
            </item>
            <item>
                <dataRef>
                    <id>form_ref</id>
                    <logic>
                        <behavior>visible</behavior>
                    </logic>
                </dataRef>
            </item>
        </flex>
    </transition>
    <transition>
        <id>t8</id>
        <x>752</x>
        <y>304</y>
        <title>Detail</title>
        <roleRef>
            <id>default</id>
            <permission>
                <perform>true</perform>
            </permission>
        </roleRef>
        <flex>
            <id>t8_0</id>
            <item>
                <dataRef>
                    <id>status</id>
                    <logic>
                        <behavior>visible</behavior>
                    </logic>
                </dataRef>
            </item>
            <item>
                <dataRef>
                    <id>answer_registration</id>
                    <logic>
                        <behavior>hidden</behavior>
                    </logic>
                </dataRef>
            </item>
            <item>
                <dataRef>
                    <id>form_ref</id>
                    <logic>
                        <behavior>visible</behavior>
                    </logic>
                </dataRef>
            </item>
        </flex>
    </transition>
    <transition>
        <id>t9</id>
        <x>656</x>
        <y>48</y>
        <title>Form</title>
        <roleRef>
            <id>system</id>
            <permission>
                <perform>true</perform>
            </permission>
        </roleRef>
        <flex>
            <id>t9_0</id>
            <item>
                <dataRef>
                    <id>name</id>
                    <logic>
                        <behavior>editable</behavior>
                        <required>true</required>
                    </logic>
                </dataRef>
            </item>
            <item>
                <dataRef>
                    <id>surname</id>
                    <logic>
                        <behavior>editable</behavior>
                        <required>true</required>
                    </logic>
                </dataRef>
            </item>
            <item>
                <dataRef>
                    <id>email</id>
                    <logic>
                        <behavior>editable</behavior>
                        <required>true</required>
                    </logic>
                </dataRef>
            </item>
            <item>
                <dataRef>
                    <id>customer_id</id>
                    <logic>
                        <behavior>editable</behavior>
                        <required>true</required>
                    </logic>
                </dataRef>
            </item>
            <item>
                <dataRef>
                    <id>request_text</id>
                    <logic>
                        <behavior>editable</behavior>
                        <required>true</required>
                    </logic>
                    <component>
                        <id>textarea</id>
                    </component>
                </dataRef>
            </item>
        </flex>
    </transition>
    <place>
        <id>p1</id>
        <x>368</x>
        <y>208</y>
        <tokens>1</tokens>
    </place>
    <place>
        <id>p2</id>
        <x>624</x>
        <y>208</y>
        <tokens>0</tokens>
    </place>
    <place>
        <id>p3</id>
        <x>848</x>
        <y>208</y>
        <tokens>0</tokens>
    </place>
    <place>
        <id>p4</id>
        <x>1104</x>
        <y>176</y>
        <tokens>0</tokens>
    </place>
    <place>
        <id>p5</id>
        <x>1328</x>
        <y>208</y>
        <tokens>0</tokens>
    </place>
    <place>
        <id>p6</id>
        <x>1584</x>
        <y>208</y>
        <tokens>0</tokens>
    </place>
    <place>
        <id>p7</id>
        <x>1104</x>
        <y>272</y>
        <tokens>0</tokens>
    </place>
    <place>
        <id>p9</id>
        <x>624</x>
        <y>304</y>
        <tokens>0</tokens>
    </place>
    <arc>
        <id>a1</id>
        <type>regular</type>
        <sourceId>p1</sourceId>
        <destinationId>t1</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a10</id>
        <type>regular</type>
        <sourceId>t5</sourceId>
        <destinationId>p6</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a12</id>
        <type>regular</type>
        <sourceId>p3</sourceId>
        <destinationId>t6</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a13</id>
        <type>regular</type>
        <sourceId>t6</sourceId>
        <destinationId>p7</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a14</id>
        <type>regular</type>
        <sourceId>p7</sourceId>
        <destinationId>t7</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a15</id>
        <type>regular</type>
        <sourceId>t7</sourceId>
        <destinationId>p5</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a17</id>
        <type>regular</type>
        <sourceId>t1</sourceId>
        <destinationId>p9</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a19</id>
        <type>read</type>
        <sourceId>p9</sourceId>
        <destinationId>t8</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a2</id>
        <type>regular</type>
        <sourceId>t1</sourceId>
        <destinationId>p2</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a3</id>
        <type>regular</type>
        <sourceId>p2</sourceId>
        <destinationId>t2</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a4</id>
        <type>regular</type>
        <sourceId>t2</sourceId>
        <destinationId>p3</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a5</id>
        <type>regular</type>
        <sourceId>p3</sourceId>
        <destinationId>t3</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a6</id>
        <type>regular</type>
        <sourceId>t3</sourceId>
        <destinationId>p4</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a7</id>
        <type>regular</type>
        <sourceId>p4</sourceId>
        <destinationId>t4</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a8</id>
        <type>regular</type>
        <sourceId>t4</sourceId>
        <destinationId>p5</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
    <arc>
        <id>a9</id>
        <type>regular</type>
        <sourceId>p5</sourceId>
        <destinationId>t5</destinationId>
        <multiplicity>1</multiplicity>
    </arc>
</process>