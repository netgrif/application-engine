<document xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://petriflow.com/petriflow.schema.xsd">
	<id>preference_item</id>
	<initials>PRI</initials>
	<title>Preference Item</title>
	<icon>check_box_outline_blank</icon>
	<defaultRole>true</defaultRole>
	<anonymousRole>false</anonymousRole>
	<transitionRole>false</transitionRole>
	<caseEvents>
		<event type="delete">
			<id>preference_item_delete</id>
			<actions phase="pre">
				<action id="0">
					removeItemChildCases(useCase)
				</action>
			</actions>
		</event>
	</caseEvents>
	<function scope="process" name="removeItemChildCases">
		{ com.netgrif.application.engine.workflow.domain.Case useCase ->

			def childCaseIds = useCase.dataSet['childItemIds'].options?.keySet() as List
			if (childCaseIds == null || childCaseIds.isEmpty()) {
				return
			}

			def childCases = workflowService.findAllById(childCaseIds)
			async.run {
				childCases.each {
					workflowService.deleteCase(it)
				}
			}
		}
	</function>
	<function scope="process" name="updateFilterAutocompleteOptions">
		{
			com.netgrif.application.engine.petrinet.domain.dataset.EnumerationMapField filterAutocomplete,
			com.netgrif.application.engine.petrinet.domain.dataset.TaskField previewTaskRef,
			com.netgrif.application.engine.petrinet.domain.dataset.CaseField selectedFilterRef,
			com.netgrif.application.engine.petrinet.domain.dataset.ButtonField updateBtn,
			com.netgrif.application.engine.petrinet.domain.Transition trans
			->
			if (filterAutocomplete.getOptions().containsKey(filterAutocomplete.value)) {
				change previewTaskRef value {
					return [findTask({it.caseId.eq(filterAutocomplete.value).and(it.transitionId.eq("view_filter"))}).stringId]
				}
				make updateBtn,editable on trans when { true }
			} else {
				change filterAutocomplete options {
				return findFilters(filterAutocomplete.value != null ? filterAutocomplete.value : "")
						.findAll({filterCase -&gt; !selectedFilterRef.value.contains(filterCase.stringId)})
						.collectEntries({filterCase -&gt; [filterCase.stringId, filterCase.title]})
				}
				change previewTaskRef value { [] }
				make updateBtn,visible on trans when { true }
			}
		}
	</function>

	<!-- GENERAL DATA-->
	<data type="number">
		<id>to_is_folder</id>
		<title>to [is_folder]</title>
		<init>1</init>
	</data>
	<data type="number">
		<id>to_is_filter</id>
		<title>to [is_filter]</title>
		<init>0</init>
	</data>
	<data type="enumeration_map" immediate="true">
		<id>type</id>
		<title name="type">Instance type</title>
		<options>
			<option key="folder">Folder</option>
			<option key="view">View</option>
		</options>
	</data>
	<data type="text">
		<id>icon</id>
		<title name="icon_identifier">Icon identifier</title>
		<desc name="icon_identifier_desc">Material icon identifier. List of icons with identifiers is available online.</desc>
		<action trigger="set">
			icon: f.this,
			iconPreview: f.icon_preview;

			changeCaseProperty "icon" about { icon.value; }

			if (icon.value == "") {
				change iconPreview value {<![CDATA["""<span></span>"""]]>}
				return;
			}

			change iconPreview value {
				<![CDATA["""<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"><span class="material-icons">"""]]> + icon.value + <![CDATA["""</span>"""]]>
			}
		</action>
	</data>
	<data type="boolean" immediate="true">
		<id>use_icon</id>
		<title name="display_icon">Display menu icon?</title>
		<init>true</init>
	</data>
	<data type="text">
		<id>icon_preview</id>
		<title name="icon_preview">Icon preview</title>
		<component>
			<name>htmltextarea</name>
		</component>
	</data>
	<data type="i18n">
		<id>name</id>
		<title name="name">Name of the item</title>
		<desc name="name_desc">Will be shown in the menu</desc>
	</data>
	<data type="text">
		<id>parentId</id>
		<title/>
	</data>
	<data type="text">
		<id>move_dest_uri</id>
		<title name="move_dest_uri">Destination URI</title>
	</data>
	<data type="i18n">
		<id>duplicate_new_title</id>
		<title name="duplicate_new_title">Title of duplicated view</title>
	</data>
	<data type="text">
		<id>duplicate_view_identifier</id>
		<title name="duplicate_view_identifier">View identifier</title>
		<desc name="duplicate_view_identifier_desc">Must be unique</desc>
	</data>
	<data type="enumeration_map">
		<id>childItemIds</id>
		<title/>
	</data>
	<data type="taskRef">
		<id>permission_settings_taskRef</id>
		<title/>
		<init>permission_settings</init>
	</data>
	<data type="taskRef">
		<id>general_settings_taskRef</id>
		<title/>
		<init>general_settings</init>
	</data>
	<data type="button">
		<id>add_allowed_roles</id>
		<title/>
		<placeholder name="allow_roles">Allow view for roles</placeholder>
		<action trigger="set">
			allowedRoles: f.allowed_roles,
			processesAvailable: f.processes_available,
			rolesAvailable: f.roles_available;

			change allowedRoles options {return configurableMenuService.addSelectedRoles(allowedRoles, processesAvailable, rolesAvailable)}

			change rolesAvailable value {[]}
			change rolesAvailable options {[:]}
			change processesAvailable value {null}
		</action>
	</data>
	<data type="button">
		<id>remove_allowed_roles</id>
		<title/>
		<placeholder name="remove_from_allowed_roles">Remove from allowed roles</placeholder>
		<action trigger="set">
			allowedRoles: f.allowed_roles,
			processesAvailable: f.processes_available,
			rolesAvailable: f.roles_available;

			change allowedRoles options {return configurableMenuService.removeSelectedRoles(allowedRoles)}

			change allowedRoles value {[]}
			change rolesAvailable value {[]}
			change rolesAvailable options {[:]}
			change processesAvailable value {null}
		</action>
	</data>
	<data type="button">
		<id>add_banned_roles</id>
		<title/>
		<placeholder name="ban_roles">Ban view for roles</placeholder>
		<action trigger="set">
			bannedRoles: f.banned_roles,
			processesAvailable: f.processes_available,
			rolesAvailable: f.roles_available;

			change bannedRoles options {return configurableMenuService.addSelectedRoles(bannedRoles, processesAvailable, rolesAvailable)}

			change rolesAvailable value {[]}
			change rolesAvailable options {[:]}
			change processesAvailable value {null}
		</action>
	</data>
	<data type="button">
		<id>remove_banned_roles</id>
		<title/>
		<placeholder name="remove_from_banned_roles">Remove from banned roles</placeholder>
		<action trigger="set">
			bannedRoles: f.banned_roles,
			processesAvailable: f.processes_available,
			rolesAvailable: f.roles_available;

			change bannedRoles options {return configurableMenuService.removeSelectedRoles(bannedRoles)}

			change bannedRoles value {[]}
			change rolesAvailable value {[]}
			change rolesAvailable options {[:]}
			change processesAvailable value {null}
		</action>
	</data>
	<data type="enumeration_map" immediate="true">
		<id>processes_available</id>
		<title name="available_processes">Your processes</title>
		<desc name="available_processes_desc">Select a process containing roles you wish to add to allowed or banned roles lists.</desc>
		<action trigger="get">
			processes: f.this;

			change processes options {return configurableMenuService.getNetsByAuthorAsMapOptions(loggedUser(), org.springframework.context.i18n.LocaleContextHolder.locale)}
		</action>
		<action trigger="set">
			processes: f.this,
			allowedRoles: f.allowed_roles,
			bannedRoles: f.banned_roles,
			rolesAvailable: f.roles_available;

			change rolesAvailable options {return configurableMenuService.getAvailableRolesFromNet(processes, allowedRoles, bannedRoles)}
			change rolesAvailable value {[]}
		</action>
	</data>
	<data type="multichoice_map" immediate="true">
		<id>roles_available</id>
		<title name="available_roles">Available roles from selected process</title>
	</data>
	<data type="multichoice_map" immediate="true">
		<id>allowed_roles</id>
		<title name="roles_allowed">Allowed roles</title>
		<desc name="roles_allowed_desc">List of roles allowed to view this menu entry.</desc>
	</data>
	<data type="multichoice_map" immediate="true">
		<id>banned_roles</id>
		<title name="roles_banned">Banned roles</title>
		<desc name="roles_banned_desc">List of roles not allowed to view this menu entry.</desc>
	</data>

	<!-- DATA FOR VIEW-->
	<data type="taskRef">
		<id>selected_filter_preview</id>
		<title/>
	</data>
	<data type="taskRef">
		<id>current_filter_preview</id>
		<title/>
	</data>
	<data type="i18n">
		<id>divider</id>
		<title/>
		<init>Current filter</init>
<!--		todo with translations, maybe get action-->
		<component>
			<name>divider</name>
		</component>
	</data>
	<data type="enumeration_map">
		<id>filter_autocomplete_selection</id>
		<title name="filter_autocomplete_selection">Select new filter</title>
		<component>
			<name>autocomplete_dynamic</name>
		</component>
		<action trigger="set">
			trans: t.view_settings,
			filterAutocomplete: f.this,
			filter_case: f.filter_case,
			update_filter: f.update_filter,
			previewTaskRef: f.selected_filter_preview;

			updateFilterAutocompleteOptions(filterAutocomplete, previewTaskRef, filter_case, update_filter, trans)
		</action>
		<action trigger="get">
			trans: t.view_settings,
			filterAutocomplete: f.this,
			filter_case: f.filter_case,
			update_filter: f.update_filter,
			previewTaskRef: f.selected_filter_preview;

			updateFilterAutocompleteOptions(filterAutocomplete, previewTaskRef, filter_case, update_filter, trans)
		</action>
	</data>
	<data type="button">
		<id>update_filter</id>
		<title/>
		<placeholder name="update_filter">Update view with selected filter</placeholder>
		<component>
			<name>raised</name>
		</component>
		<action trigger="set">
			trans: t.view_settings,
			update_filter: f.update_filter,
			filter_case: f.filter_case,
			filterAutocomplete: f.filter_autocomplete_selection;

			change filter_case value { [filterAutocomplete.value] }
			change filterAutocomplete value { "" }
			make update_filter,visible on trans when { true }
		</action>
	</data>
	<data type="caseRef">
		<id>filter_case</id>
		<title/>
		<action trigger="set">
			filterTaskRef: f.current_filter_preview,
			filterCaseRef: f.filter_case;

			def filterCase = findCase({it._id.eq(filterCaseRef.value[0])})
			change filterTaskRef value {return [findTask({it.caseId.eq(filterCase.stringId).and(it.transitionId.eq("view_filter"))}).stringId]}
		</action>
		<allowedNets>
			<allowedNet>filter</allowedNet>
		</allowedNets>
	</data>
	<data type="text" immediate="true">
		<id>menu_item_identifier</id>
		<title>Identifier (Filter API)</title>
	</data>
	<data type="text" immediate="true">
		<id>default_headers</id>
		<title name="default_headers">Set default headers</title>
	</data>
	<data type="enumeration_map" immediate="true">
		<id>search_type</id>
		<title name="search_type">Search type</title>
		<options>
			<option key="hidden">Hidden</option>
			<option key="fulltext">Fulltext</option>
			<option key="fulltext_advanced">Fulltext and advanced</option>
		</options>
	</data>
	<data type="text" immediate="true">
		<id>create_case_button_title</id>
		<title name="create_case_button_title">"New case" button title</title>
	</data>
	<data type="text">
		<id>create_case_button_icon_preview</id>
		<title name="create_case_button_icon_preview">Menu icon preview</title>
		<component>
			<name>htmltextarea</name>
		</component>
	</data>
	<data type="text" immediate="true">
		<id>create_case_button_icon</id>
		<title name="create_case_button_icon">"New case" button icon identifier</title>
		<action trigger="set">
			create_case_button_icon_preview: f.create_case_button_icon_preview,
			create_case_button_icon: f.create_case_button_icon;


			if (create_case_button_icon.value == "") {
				change create_case_button_icon_preview value {<![CDATA["""<span></span>"""]]>}
				return;
			}

			change create_case_button_icon_preview value {
				<![CDATA["""<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"><span class="material-icons">"""]]> + create_case_button_icon.value + <![CDATA["""</span>"""]]>
			}
		</action>
	</data>

	<!-- DATA FOR FOLDER-->
	<data type="text" immediate="true">
		<id>nodePath</id>
		<title/>
		<event type="set">
			<id>0</id>
			<actions phase="post">
				<action>
					nodePath: f.nodePath,
					nodeName: f.nodeName;

					change nodeName value {
						def idx = nodePath.value.lastIndexOf(uriService.getUriSeparator())
						return nodePath.value.substring(idx + 1)
					}
				</action>
			</actions>
		</event>
	</data>
	<data type="text">
		<id>nodeName</id>
		<title/>
	</data>

	<!-- I18NS -->
	<i18n locale="sk">
		<i18nString name="menu_item_title">Názov položky menu</i18nString>
		<i18nString name="display_icon">Zobrazovať ikonu?</i18nString>
		<i18nString name="icon_preview">Náhľad ikony</i18nString>
		<i18nString name="icon_identifier">Identifikátor ikony</i18nString>
		<i18nString name="icon_identifier_desc">Identifikátor Material ikony. Zoznam ikon s identifikátormi je dostupný online.</i18nString>
		<i18nString name="allow_roles">Pridaj k povoleným roliam</i18nString>
		<i18nString name="remove_from_allowed_roles">Odstráň z povolených rolí</i18nString>
		<i18nString name="ban_roles">Pridaj k zakázaným roliam</i18nString>
		<i18nString name="remove_from_banned_roles">Odstráň zo zakázaných rolí</i18nString>
		<i18nString name="processes_available">Vaše procesy</i18nString>
		<i18nString name="available_processes_desc">Vyberte proces obsahujúci roly ktoré chcete pridať do zoznamu povolených alebo zakázaných rolí.</i18nString>
		<i18nString name="roles_available">Dostupné roly</i18nString>
		<i18nString name="allowed_roles">Povolené roly</i18nString>
		<i18nString name="banned_roles">Zakázané roly</i18nString>
		<i18nString name="create_case_button_title">Názov tlačidla "Nová inštancia"</i18nString>
		<i18nString name="create_case_button_icon">Identifikátor ikony tlačidla "Nová inštancia"</i18nString>
		<i18nString name="create_case_button_icon_preview">Náhľad ikony</i18nString>
		<i18nString name="default_headers">Predvolené hlavičky</i18nString>
		<i18nString name="filter_autocomplete_selection">Zvoľte nový filter</i18nString>
		<i18nString name="type">todo</i18nString>
		<i18nString name="folder">todo</i18nString>
		<i18nString name="view">todo</i18nString>
		<i18nString name="name">todo</i18nString>
		<i18nString name="name_desc">todo</i18nString>
		<i18nString name="move_dest_uri">todo</i18nString>
		<i18nString name="duplicate_new_title">todo</i18nString>
		<i18nString name="duplicate_view_identifier">todo</i18nString>
		<i18nString name="duplicate_view_identifier_desc">todo</i18nString>
		<i18nString name="update_filter">todo</i18nString>
		<i18nString name="search_type">todo</i18nString>
		<i18nString name="hidden">todo</i18nString>
		<i18nString name="fulltext">todo</i18nString>
		<i18nString name="fulltext_advanced">todo</i18nString>
		<i18nString name="folder_settings">todo</i18nString>
		<i18nString name="view_settings">todo</i18nString>
		<i18nString name="filter_update_title">todo</i18nString>
		<i18nString name="roles_management_title">todo</i18nString>
		<i18nString name="move_item">todo</i18nString>
		<i18nString name="move_item_finish">todo</i18nString>
		<i18nString name="duplicate_item">todo</i18nString>
		<i18nString name="duplicate_item_finish">todo</i18nString>
	</i18n>
	<i18n locale="de">
		<i18nString name="menu_item_title">Menüpunkttitel</i18nString>
		<i18nString name="display_icon">Menüikone anzeigen</i18nString>
		<i18nString name="icon_preview">Ikonevorschau</i18nString>
		<i18nString name="icon_identifier">Ikone ID</i18nString>
		<i18nString name="icon_identifier_desc">Material Ikone ID. Liste den Ikonen mit IDs ist online verfügbar.</i18nString>
		<i18nString name="allow_roles">Zu zulässigen Rollen hinzufügen</i18nString>
		<i18nString name="remove_from_allowed_roles">Aus zulässigen Rollen entfernen</i18nString>
		<i18nString name="ban_roles">Zu verbotenen Rollen hinzufügen</i18nString>
		<i18nString name="remove_from_banned_roles">Aus verbotenen Rollen entfernen</i18nString>
		<i18nString name="processes_available">Ihre Prozesse</i18nString>
		<i18nString name="available_processes_desc">Wählen Sie einen Prozess mit Rollen aus, die Sie zu Listen mit zulässigen oder verbotenen Rollen hinzufügen möchten.</i18nString>
		<i18nString name="roles_available">Verfügbare Rollen</i18nString>
		<i18nString name="allowed_roles">Zulässige Rollen</i18nString>
		<i18nString name="banned_roles">Verbotene Rollen</i18nString>
		<i18nString name="create_case_button_title">Schaltflächentitel "Neuer Fall"</i18nString>
		<i18nString name="create_case_button_icon">Ikone ID</i18nString>
		<i18nString name="create_case_button_icon_preview">Ikonevorschau</i18nString>
		<i18nString name="default_headers">Anzuzeigende Attributmenge auswählen</i18nString>
		<i18nString name="filter_autocomplete_selection">Neue Filter auswählen</i18nString>
		<i18nString name="type">todo</i18nString>
		<i18nString name="folder">todo</i18nString>
		<i18nString name="view">todo</i18nString>
		<i18nString name="name">todo</i18nString>
		<i18nString name="name_desc">todo</i18nString>
		<i18nString name="move_dest_uri">todo</i18nString>
		<i18nString name="duplicate_new_title">todo</i18nString>
		<i18nString name="duplicate_view_identifier">todo</i18nString>
		<i18nString name="duplicate_view_identifier_desc">todo</i18nString>
		<i18nString name="update_filter">todo</i18nString>
		<i18nString name="search_type">todo</i18nString>
		<i18nString name="hidden">todo</i18nString>
		<i18nString name="fulltext">todo</i18nString>
		<i18nString name="fulltext_advanced">todo</i18nString>
		<i18nString name="folder_settings">todo</i18nString>
		<i18nString name="view_settings">todo</i18nString>
		<i18nString name="filter_update_title">todo</i18nString>
		<i18nString name="roles_management_title">todo</i18nString>
		<i18nString name="move_item">todo</i18nString>
		<i18nString name="move_item_finish">todo</i18nString>
		<i18nString name="duplicate_item">todo</i18nString>
		<i18nString name="duplicate_item_finish">todo</i18nString>
	</i18n>

	<!-- TRANSITIONS -->
	<transition>
		<id>initialize</id>
		<x>340</x>
		<y>220</y>
		<label>initialize [await sync]</label>
		<icon>hourglass_empty</icon>
		<dataGroup>
			<id>generic</id>
			<dataRef>
				<id>type</id>
				<logic>
					<behavior>forbidden</behavior>
					<action trigger="set">
						to_is_folder: f.to_is_folder,
						to_is_filter: f.to_is_filter,
						icon: f.icon,
						type: f.type;

						def selected = type.value as String
						if (selected == "folder") {
							change to_is_folder value { 1.0 }
							change to_is_filter value { 0.0 }
							change icon value { "folder" }
						} else if (selected == "view") {
							change to_is_folder value { 0.0 }
							change to_is_filter value { 1.0 }
							change icon value { "filter_alt" }
						}
					</action>
				</logic>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>folder</id>

		</dataGroup>
		<dataGroup>
			<id>view</id>
			<dataRef>
				<id>filter_case</id>
				<logic>
					<behavior>forbidden</behavior>
					<action trigger="set">
						filterCaseRef: f.filter_case,
						name: f.name;

						def filterCase = findCase({it._id.eq(filterCaseRef.value[0])})
						change name value {return filterCase.dataSet["i18n_filter_name"].value}
					</action>
				</logic>
			</dataRef>
		</dataGroup>
	</transition>

	<transition>
		<id>folder_settings</id>
		<x>620</x>
		<y>100</y>
		<label name="folder_settings">Folder settings</label>
		<icon>settings</icon>
		<dataGroup>
			<id>general</id>
			<cols>5</cols>
			<layout>grid</layout>
			<dataRef>
				<id>general_settings_taskRef</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>5</cols>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>folder_settings_0</id>
			<cols>5</cols>
			<layout>grid</layout>

		</dataGroup>
		<dataGroup>
			<id>roles</id>
			<cols>5</cols>
			<layout>grid</layout>
			<dataRef>
				<id>permission_settings_taskRef</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>5</cols>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
	</transition>

	<transition>
		<id>view_settings</id>
		<x>620</x>
		<y>340</y>
		<label name="view_settings">View settings</label>
		<icon>settings</icon>
		<dataGroup>
			<id>general</id>
			<cols>5</cols>
			<layout>grid</layout>
			<dataRef>
				<id>general_settings_taskRef</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>5</cols>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>view_settings_0</id>
			<cols>4</cols>
			<layout>grid</layout>
			<dataRef>
				<id>default_headers</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>search_type</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>2</y>
					<rows>1</rows>
					<cols>2</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>create_case_button_title</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>3</y>
					<rows>1</rows>
					<cols>2</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>create_case_button_icon_preview</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>2</x>
					<y>3</y>
					<rows>1</rows>
					<cols>1</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>standard</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>create_case_button_icon</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>3</x>
					<y>3</y>
					<rows>1</rows>
					<cols>1</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>filter_update</id>
			<cols>4</cols>
			<layout>grid</layout>
			<title name="filter_update_title">Filter section</title>
			<dataRef>
				<id>filter_autocomplete_selection</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>3</cols>
					<template>material</template>
					<appearance>standard</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>update_filter</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>3</x>
					<y>0</y>
					<rows>1</rows>
					<cols>1</cols>
					<template>material</template>
					<appearance>standard</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>selected_filter_preview</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>1</rows>
					<cols>4</cols>
					<template>material</template>
					<appearance>standard</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>current_filter</id>
			<cols>4</cols>
			<layout>grid</layout>
			<dataRef>
				<id>divider</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>current_filter_preview</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>1</rows>
					<cols>4</cols>
					<template>material</template>
					<appearance>standard</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>roles</id>
			<cols>5</cols>
			<layout>grid</layout>
			<dataRef>
				<id>permission_settings_taskRef</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>5</cols>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
	</transition>

	<transition>
		<id>general_settings</id>
		<x>220</x>
		<y>340</y>
		<label>General settings [referenced]</label>
		<icon>settings</icon>
		<dataGroup>
			<id>general_0</id>
			<cols>5</cols>
			<layout>grid</layout>
			<dataRef>
				<id>name</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>2</cols>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>use_icon</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>2</x>
					<y>0</y>
					<rows>1</rows>
					<cols>1</cols>
					<offset>0</offset>
					<template>material</template>
				</layout>
				<event type="set">
					<id>0</id>
					<actions phase="post">
						<action>
							trans: t.this,
							iconPreview: f.icon_preview,
							icon: f.icon,
							useIcon: f.use_icon;

							make iconPreview,visible on trans when { useIcon.value }
							make icon,editable on trans when { useIcon.value }

							make iconPreview,hidden on trans when { !useIcon.value }
							make icon,hidden on trans when { !useIcon.value }
						</action>
					</actions>
				</event>
			</dataRef>
			<dataRef>
				<id>icon</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>3</x>
					<y>0</y>
					<rows>1</rows>
					<cols>1</cols>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>icon_preview</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>4</x>
					<y>0</y>
					<rows>1</rows>
					<cols>1</cols>
					<template>material</template>
					<appearance>standard</appearance>
				</layout>
			</dataRef>
		</dataGroup>
	</transition>

	<transition>
		<id>permission_settings</id>
		<x>220</x>
		<y>100</y>
		<label>Permission settings [referenced]</label>
		<icon>accessibility</icon>
		<dataGroup>
			<id>roles_management</id>
			<cols>5</cols>
			<layout>grid</layout>
			<title name="roles_management_title">Roles section</title>
			<dataRef>
				<id>processes_available</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>2</rows>
					<cols>1</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>roles_available</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>1</x>
					<y>0</y>
					<rows>2</rows>
					<cols>1</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>add_allowed_roles</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>2</x>
					<y>0</y>
					<rows>1</rows>
					<cols>1</cols>
					<offset>0</offset>
					<template>material</template>
				</layout>
			</dataRef>
			<dataRef>
				<id>allowed_roles</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>3</x>
					<y>0</y>
					<rows>1</rows>
					<cols>1</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>remove_allowed_roles</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>4</x>
					<y>0</y>
					<rows>1</rows>
					<cols>1</cols>
					<offset>0</offset>
					<template>material</template>
				</layout>
			</dataRef>
			<dataRef>
				<id>add_banned_roles</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>2</x>
					<y>1</y>
					<rows>1</rows>
					<cols>1</cols>
					<offset>0</offset>
					<template>material</template>
				</layout>
			</dataRef>
			<dataRef>
				<id>banned_roles</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>3</x>
					<y>1</y>
					<rows>1</rows>
					<cols>1</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>remove_banned_roles</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>4</x>
					<y>1</y>
					<rows>1</rows>
					<cols>1</cols>
					<offset>0</offset>
					<template>material</template>
				</layout>
			</dataRef>
		</dataGroup>
	</transition>

	<transition>
		<id>move_item</id>
		<x>820</x>
		<y>220</y>
		<label name="move_item">Move item</label>
		<icon>move_down</icon>
		<dataGroup>
			<id>move</id>
			<cols>4</cols>
			<layout>grid</layout>
			<dataRef>
				<id>move_dest_uri</id>
				<logic>
					<behavior>editable</behavior>
					<behavior>required</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<event type="finish">
			<id>finish</id>
			<actions phase="pre">
				<action>
					dest: f.move_dest_uri;

					if (dest.value == "") {
						throw new IllegalArgumentException("URI must not be empty!")
					}

					changeMenuItem useCase uri { dest.value }
				</action>
			</actions>
			<title name="move_item_finish">Move</title>
		</event>
	</transition>

	<transition>
		<id>duplicate_item</id>
		<x>620</x>
		<y>460</y>
		<label name="duplicate_item">Duplicate item</label>
		<icon>content_copy</icon>
		<dataGroup>
			<id>duplicate</id>
			<cols>4</cols>
			<layout>grid</layout>
			<dataRef>
				<id>duplicate_new_title</id>
				<logic>
					<behavior>editable</behavior>
					<behavior>required</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>duplicate_view_identifier</id>
				<logic>
					<behavior>editable</behavior>
					<behavior>required</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>1</rows>
					<cols>4</cols>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<event type="finish">
			<id>finish</id>
			<actions phase="pre">
				<action>
					identifier: f.duplicate_view_identifier,
					title: f.duplicate_new_title;

					duplicateViewItem(useCase, title.value, identifier.value)
				</action>
			</actions>
			<title name="duplicate_item_finish">Duplicate</title>
		</event>
	</transition>

	<!-- PLACES-->
	<place>
		<id>uninitialized</id>
		<x>220</x>
		<y>220</y>
		<label>uninitialized</label>
		<tokens>1</tokens>
		<static>false</static>
	</place>
	<place>
		<id>is_folder</id>
		<x>460</x>
		<y>100</y>
		<label>is_folder</label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>is_filter</id>
		<x>460</x>
		<y>340</y>
		<label>is_filter</label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>general</id>
		<x>620</x>
		<y>220</y>
		<label>general</label>
		<tokens>0</tokens>
		<static>false</static>
	</place>

	<!-- ARCS-->
	<arc>
		<id>a1</id>
		<type>regular</type>
		<sourceId>uninitialized</sourceId>
		<destinationId>initialize</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a2</id>
		<type>regular</type>
		<sourceId>initialize</sourceId>
		<destinationId>is_folder</destinationId>
		<multiplicity>1</multiplicity>
		<reference>to_is_folder</reference>
	</arc>
	<arc>
		<id>a3</id>
		<type>regular</type>
		<sourceId>initialize</sourceId>
		<destinationId>is_filter</destinationId>
		<multiplicity>0</multiplicity>
		<reference>to_is_filter</reference>
	</arc>
	<arc>
		<id>a6</id>
		<type>read</type>
		<sourceId>is_folder</sourceId>
		<destinationId>folder_settings</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a7</id>
		<type>read</type>
		<sourceId>is_filter</sourceId>
		<destinationId>view_settings</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a8</id>
		<type>regular</type>
		<sourceId>initialize</sourceId>
		<destinationId>general</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a9</id>
		<type>read</type>
		<sourceId>general</sourceId>
		<destinationId>move_item</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>a10</id>
		<type>read</type>
		<sourceId>is_filter</sourceId>
		<destinationId>duplicate_item</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
</document>